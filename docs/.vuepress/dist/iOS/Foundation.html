<div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Hello VuePress" class="logo"> <span class="site-name can-hide">Hello VuePress</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/iOS/" class="nav-link router-link-active">
  iOS
</a></div><div class="nav-item"><a href="/iOS/AAA-one.html" class="nav-link">
  iOS-One
</a></div><div class="nav-item"><a href="/bar/" class="nav-link">
  Bar
</a></div><div class="nav-item"><a href="https://cl9000.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言菜单" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese/" class="nav-link">
  汉语
</a></li><li class="dropdown-item"><!----> <a href="/language/english/" class="nav-link">
  英语
</a></li><li class="dropdown-item"><h4>
          Group1
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">
  日语
</a></li></ul></li></ul></div></div> <a href="https://github.com/cl9000/web-code" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/iOS/" class="nav-link router-link-active">
  iOS
</a></div><div class="nav-item"><a href="/iOS/AAA-one.html" class="nav-link">
  iOS-One
</a></div><div class="nav-item"><a href="/bar/" class="nav-link">
  Bar
</a></div><div class="nav-item"><a href="https://cl9000.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言菜单" class="dropdown-title"><span class="title">选择语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/chinese/" class="nav-link">
  汉语
</a></li><li class="dropdown-item"><!----> <a href="/language/english/" class="nav-link">
  英语
</a></li><li class="dropdown-item"><h4>
          Group1
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/language/chinese/" class="nav-link">
  日语
</a></li></ul></li></ul></div></div> <a href="https://github.com/cl9000/web-code" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><a href="/" class="sidebar-heading clickable router-link-active"><span>首页</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">CL9000</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>iOS-Interview</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/iOS/" aria-current="page" class="sidebar-link">关于 | iOS-Interview</a></li><li><a href="/iOS/AAA-one.html" class="sidebar-link">iOS面试题整理</a></li><li><a href="/iOS/Data-structure.html" class="sidebar-link">数据结构</a></li><li><a href="/iOS/Arithmetic.html" class="sidebar-link">算法</a></li><li><a href="/iOS/Foundation.html" aria-current="page" class="active sidebar-link">Foundation</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_1-nil、nil、nsnull-有什么区别？" class="sidebar-link">1.nil、NIL、NSNULL 有什么区别？</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_2-如何实现一个线程安全的-nsmutablearray" class="sidebar-link">2.如何实现一个线程安全的 NSMutableArray?</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_3-atomic-修饰的属性是绝对安全的吗？为什么？" class="sidebar-link">3.atomic 修饰的属性是绝对安全的吗？为什么？</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_4-实现-isequal-和-hash-方法时要注意什么？" class="sidebar-link">4.实现 isEqual 和 hash 方法时要注意什么？</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_5-id-和-instancetype-有什么区别？" class="sidebar-link">5.id 和 instanceType 有什么区别？</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_6-self和super的区别" class="sidebar-link">6.self和super的区别</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_7-synthesize和-dynamic分别有什么作用？" class="sidebar-link">7.@synthesize和@dynamic分别有什么作用？</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_8-typeof-和-typeof，typeof-的区别" class="sidebar-link">8.typeof 和 _typeof，typeof_ 的区别?</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_9-类族" class="sidebar-link">9.类族</a></li><li class="sidebar-sub-header"><a href="/iOS/Foundation.html#_10-struct和class的区别" class="sidebar-link">10.struct和class的区别</a></li></ul></li><li><a href="/iOS/UIKit.html" class="sidebar-link">UIKit</a></li><li><a href="/iOS/WebView.html" class="sidebar-link">WebView</a></li><li><a href="/iOS/Memory-management.html" class="sidebar-link">内存管理</a></li><li><a href="/iOS/Message-passing.html" class="sidebar-link">消息传递的方式</a></li><li><a href="/iOS/Network.html" class="sidebar-link">网络</a></li><li><a href="/iOS/Data-storage.html" class="sidebar-link">数据存储</a></li><li><a href="/iOS/Multi-thread.html" class="sidebar-link">多线程</a></li><li><a href="/iOS/Animation.html" class="sidebar-link">动画</a></li><li><a href="/iOS/Image-processing.html" class="sidebar-link">图像处理</a></li><li><a href="/iOS/Data-encryption.html" class="sidebar-link">数据安全及加密</a></li><li><a href="/iOS/Runtime.html" class="sidebar-link">Runtime</a></li><li><a href="/iOS/Runloop.html" class="sidebar-link">Runloop</a></li><li><a href="/iOS/Project-organization.html" class="sidebar-link">项目架构</a></li><li><a href="/iOS/Design-patterns.html" class="sidebar-link">设计模式</a></li><li><a href="/iOS/Component-based.html" class="sidebar-link">组件化</a></li><li><a href="/iOS/Debug-tips.html" class="sidebar-link">调试技巧</a></li><li><a href="/iOS/Performance-optimization.html" class="sidebar-link">性能优化</a></li><li><a href="/iOS/Source-code.html" class="sidebar-link">源码理解</a></li><li><a href="/iOS/Code-management.html" class="sidebar-link">代码管理</a></li><li><a href="/iOS/Continuous-integration.html" class="sidebar-link">持续集成</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Bar</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Contact</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>About</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="foundation"><a href="#foundation" class="header-anchor">#</a> Foundation</h1> <h2 id="_1-nil、nil、nsnull-有什么区别？"><a href="#_1-nil、nil、nsnull-有什么区别？" class="header-anchor">#</a> 1.nil、NIL、NSNULL 有什么区别？</h2> <ul><li><p>nil、NIL 可以说是等价的，都代表内存中一块空地址。</p></li> <li><p>NSNULL 代表一个指向 nil 的对象。</p></li></ul> <h2 id="_2-如何实现一个线程安全的-nsmutablearray"><a href="#_2-如何实现一个线程安全的-nsmutablearray" class="header-anchor">#</a> 2.如何实现一个线程安全的 NSMutableArray?</h2> <p>NSMutableArray是线程不安全的，当有多个线程同时对数组进行操作的时候可能导致崩溃或数据错误</p> <ul><li><p>线程锁：使用线程锁对数组读写时进行加锁</p></li> <li><p>派发队列：在《Effective Objective-C 2.0..》书中第41条：多用派发队列，少用同步锁中指出：使用“串行同步队列”（serial synchronization queue），将读取操作及写入操作都安排在同一个队列里，即可保证数据同步。而通过并发队列，结合GCD的栅栏块（barrier）来不仅实现数据同步线程安全，还比串行同步队列方式更高效。</p></li></ul> <h2 id="_3-atomic-修饰的属性是绝对安全的吗？为什么？"><a href="#_3-atomic-修饰的属性是绝对安全的吗？为什么？" class="header-anchor">#</a> 3.atomic 修饰的属性是绝对安全的吗？为什么？</h2> <p>不是，所谓的安全只是局限于 Setter、Getter 的访问器方法而言的，你对它做 Release 的操作是不会受影响的。这个时候就容易崩溃了。</p> <h2 id="_4-实现-isequal-和-hash-方法时要注意什么？"><a href="#_4-实现-isequal-和-hash-方法时要注意什么？" class="header-anchor">#</a> 4.实现 isEqual 和 hash 方法时要注意什么？</h2> <ul><li><p>hash</p> <p>对关键属性的hash值进行位或运算作为hash值</p></li> <li><p>isEqual</p> <p>==运算符判断是否是同一对象, 因为同一对象必然完全相同</p> <p>判断是否是同一类型, 这样不仅可以提高判等的效率, 还可以避免隐式类型转换带来的潜在风险</p> <p>判断对象是否是nil, 做参数有效性检查</p> <p>各个属性分别使用默认判等方法进行判断</p> <p>返回所有属性判等的与结果</p></li></ul> <h2 id="_5-id-和-instancetype-有什么区别？"><a href="#_5-id-和-instancetype-有什么区别？" class="header-anchor">#</a> 5.id 和 instanceType 有什么区别？</h2> <ul><li><p>相同点</p> <p>instancetype 和 id 都是万能指针，指向对象。</p></li> <li><p>不同点：</p> <p>1.id 在编译的时候不能判断对象的真实类型，instancetype 在编译的时候可以判断对象的真实类型。</p> <p>2.id 可以用来定义变量，可以作为返回值类型，可以作为形参类型；instancetype 只能作为返回值类型。</p></li></ul> <h2 id="_6-self和super的区别"><a href="#_6-self和super的区别" class="header-anchor">#</a> 6.self和super的区别</h2> <ul><li><p>self调用自己方法，super调用父类方法</p></li> <li><p>self是类，super是预编译指令</p></li> <li><p>[self class] 和 [super class] 输出是一样的</p></li> <li><p>self和super底层实现原理</p> <p>1.当使用 self 调用方法时，会从当前类的方法列表中开始找，如果没有，就从父类中再找；</p> <p>而当使用 super 时，则从父类的方法列表中开始找，然后调用父类的这个方法</p> <p>2.当使用 self 调用时，会使用 objc_msgSend 函数：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>id <span class="token function">objc_msgSend</span><span class="token punctuation">(</span>id theReceiver<span class="token punctuation">,</span> SEL theSelector<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第一个参数是消息接收者，第二个参数是调用的具体类方法的 selector，后面是 selector 方法的可变参数。以 [self setName:] 为例，编译器会替换成调用 objc_msgSend 的函数调用，其中 theReceiver 是 self，theSelector 是 @selector(setName:)，这个 selector 是从当前 self 的 class 的方法列表开始找的 setName，当找到后把对应的 selector 传递过去。</p> <p>3.当使用 super 调用时，会使用 objc_msgSendSuper 函数：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>id <span class="token function">objc_msgSendSuper</span><span class="token punctuation">(</span><span class="token keyword">struct</span> <span class="token class-name">objc_super</span> <span class="token operator">*</span>super<span class="token punctuation">,</span> SEL op<span class="token punctuation">,</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>第一个参数是个objc_super的结构体，第二个参数还是类似上面的类方法的selector</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">struct</span> <span class="token class-name">objc_super</span> <span class="token punctuation">{</span>
	id receiver<span class="token punctuation">;</span>
	Class superClass<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <h2 id="_7-synthesize和-dynamic分别有什么作用？"><a href="#_7-synthesize和-dynamic分别有什么作用？" class="header-anchor">#</a> 7.@synthesize和@dynamic分别有什么作用？</h2> <ul><li><p>@property有两个对应的词，一个是 @synthesize，一个是 @dynamic。如果 @synthesize和 @dynamic都没写，那么默认的就是@syntheszie var = _var;</p></li> <li><p>@synthesize 的语义是如果你没有手动实现 setter 方法和 getter 方法，那么编译器会自动为你加上这两个方法。</p></li> <li><p>@dynamic 告诉编译器：属性的 setter 与 getter 方法由用户自己实现，不自动生成。（当然对于 readonly 的属性只需提供 getter 即可）。假如一个属性被声明为 @dynamic var，然后你没有提供 @setter方法和 @getter 方法，编译的时候没问题，但是当程序运行到 instance.var = someVar，由于缺 setter 方法会导致程序崩溃；或者当运行到 someVar = var 时，由于缺 getter 方法同样会导致崩溃。编译时没问题，运行时才执行相应的方法，这就是所谓的动态绑定。</p></li></ul> <h2 id="_8-typeof-和-typeof，typeof-的区别"><a href="#_8-typeof-和-typeof，typeof-的区别" class="header-anchor">#</a> 8.typeof 和 __typeof，<strong>typeof</strong> 的区别?</h2> <ul><li><p>__typeof __() 和 __typeof() 是 C语言 的编译器特定扩展，因为标准 C 不包含这样的运算符。 标准 C 要求编译器用双下划线前缀语言扩展（这也是为什么你不应该为自己的函数，变量等做这些）</p></li> <li><p>typeof() 与前两者完全相同的，只不过去掉了下划线，同时现代的编译器也可以理解。</p></li></ul> <p>所以这三个意思是相同的，但没有一个是标准C，不同的编译器会按需选择符合标准的写法。</p> <h2 id="_9-类族"><a href="#_9-类族" class="header-anchor">#</a> 9.类族</h2> <p>系统框架中有许多类簇，大部分collection类都是类族。例如NSArray与其可变版本NSMutableArray。这样看来实际上有两个抽象基类，一个用于不可变数组，一个用于可变数组。尽管具备公共接口的类有两个，但任然可以合起来算一个类族。不可变的类定义了对所有数组都通用的方法，而可变类则定义了那些只适用于可变数组的方法。两个类共同属于同一个类族，这意味着二者在实现各自类型的数组时可以共用实现代码，此外还能把可变数组复制成不可变数组，反之亦然。</p> <h2 id="_10-struct和class的区别"><a href="#_10-struct和class的区别" class="header-anchor">#</a> 10.struct和class的区别</h2> <ul><li><p>类： 引用类型（位于栈上面的指针（引用）和位于堆上的实体对象）</p></li> <li><p>结构：值类型（实例直接位于栈中）</p></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/cl9000/web-code/edit/master/docs/iOS/Foundation.md" target="_blank" rel="noopener noreferrer">在 GitHub 上编辑此页</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/2/2020, 3:17:21 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/iOS/Arithmetic.html" class="prev">
        算法
      </a></span> <span class="next"><a href="/iOS/UIKit.html">
        UIKit
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>